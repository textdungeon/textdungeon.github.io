<!DOCTYPE html>
<html>
	<head>
		<title>Text Dungeon</title>
		<style>
			body{
				background-color:black;
			}
		</style>
	</head>
	<body>
		<canvas id="canvas"></canvas>
		<script>
			var map=[
				"1111111111111111111111111111111111111111111111111111111111111111",
				"1001000100000000001000001000000000010001000000000010000010000001",
				"1001000111000000001000001000000110010001110000000010000010000001",
				"1001000000000000001000001000000110010000000000000010000010000001",
				"1001000110000000000000001100000110010001100000000000000011000001",
				"1001001100000000001000000000000110010011000000000010000000000001",
				"1001001000000000001111000100000110010010000000000011110001000001",
				"1001111001101110000001000100000110011110011011100000010001000001",
				"1000000000000010000001000111111110000000000000100000010001111111",
				"1001111001101111001001000001000110011110011011110010010000010001",
				"1000010001000001001111110001000110000100010000010011111100010001",
				"1000010001100001000000010001000110000100011000010000000100010001",
				"1000010000000001111111010001000110000100000000011111110100010001",
				"1000011111100001000001010000000110000111111000010000010100000001",
				"1000000000000000000001000000000110000000000000000000010000000001",
				"1111111111111111111111111111111111111111111111111111111111111101",
				"1111111111111111111111111111111111111111111111111111111111111101",
				"1001000100000000001000001000000110010001000000000010000010000001",
				"1001000111000000001000001000000110010001110000000010000010000001",
				"1001000000000000001000001000000110010000000000000010000010000001",
				"1001000110000000000000001100000110010001100000000000000011000001",
				"1001001100000000001000000000000110010011000000000010000000000001",
				"1001001000000000001111000100000110010010000000000011110001000001",
				"1001111001101110000001000100000110011110011011100000010001000001",
				"1000000000000010000001000111111110000000000000100000010001111111",
				"1001111001101111001001000001000110011110011011110010010000010001",
				"1000010001000001001111110001000110000100010000010011111100010001",
				"1000010001100001000000010001000110000100011000010000000100010001",
				"1000010000000001111111010001000110000100000000011111110100010001",
				"1000011111100001000001010000000110000111111000010000010100000001",
				"1000000000000000000001000000000000000000000000000000010000000001",
				"1111111111111111111111111111111111111111111111111111111111111111"
			];
			var p=[1,1];
			var e=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]];
			var canvas=document.getElementById("canvas");
			var width=window.innerWidth;
			var height=window.innerHeight;
			canvas.width=width;
			canvas.height=height;
			var ctx=canvas.getContext("2d");
			ctx.font="15px Monospace";
			function text(str,x,y,color){
				ctx.fillStyle=color;
				for(var i=0;i<str.length;i++){
					ctx.fillText(str[i],width/2+x*10+i*10,height/2+10+y*10);
				}
			}
			function setup(){
				for(var i=0;i<24;i++){
					e[i][0]=Math.floor(64*Math.random());
					e[i][1]=Math.floor(32*Math.random());
					while(map[Math.floor(e[i][1])][Math.floor(e[i][0])]=="1"){
						e[i][0]=Math.floor(64*Math.random());
						e[i][1]=Math.floor(32*Math.random());
					}
				}
			}
			function draw(){
				text("~",0,0,"#0000ff");
				for(var i=0;i<24;i++){
					text("x",Math.floor(e[i][0]-p[0]),Math.floor(e[i][1]-p[1]),"#ff0000");
				}
				for(var xi=0;xi<64;xi++){
					for(var yi=0;yi<32;yi++){
						if(map[yi][xi]=="1"){
							text("#",xi-p[0],yi-p[1],"#ffffff");
						}
					}
				}
			}
			function move(){
				for(var i=0;i<24;i++){
					var r1=Math.floor(3*Math.random())-1;
					var r2=Math.floor(3*Math.random())-1;
					e[i][0]+=r1/3;
					e[i][1]+=r2/3;
					if(map[Math.floor(e[i][1])][Math.floor(e[i][0])]=="1"){
						e[i][0]-=r1/3;
						e[i][1]-=r2/3;
					}
				}
			}
			function loop(){
				ctx.clearRect(0,0,width,height);
				move();
				draw();
			}
			setup();
			setInterval(loop,50);
			document.onkeypress=function(e){
				e=e||window.event;
				var mx=0;
				var my=0;
				switch(e.key){
					case "w":
						p[1]--;
						my--;
						break;
					case "a":
						p[0]--;
						mx--;
						break;
					case "s":
						p[1]++;
						my++;
						break;
					case "d":
						p[0]++;
						mx++;
						break;
				}
				if(map[p[1]][p[0]]=="1"){
					p[0]-=mx;
					p[1]-=my;
				}
			};
		</script>
</html>
